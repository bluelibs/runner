<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@bluelibs/runner - v1.2.0</title><meta name="description" content="Documentation for @bluelibs/runner"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@bluelibs/runner - v1.2.0</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>@bluelibs/runner - v1.2.0</h2></div><div class="tsd-panel tsd-typography"><a id="md:bluelibs-runner" class="tsd-anchor"></a><h1 class="tsd-anchor-link">BlueLibs Runner<a href="#md:bluelibs-runner" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p align="center">
<a href="https://travis-ci.org/bluelibs/runner"><img src="https://github.com/bluelibs/runner/actions/workflows/ci.yml/badge.svg?branch=main" alt="Build Status" /></a>
<a href="https://coveralls.io/github/bluelibs/runner?branch=main"><img src="https://coveralls.io/repos/github/bluelibs/runner/badge.svg?branch=main" alt="Coverage Status" /></a>
<a href="https://bluelibs.github.io/runner/" target="_blank"><img src="https://img.shields.io/badge/read-typedocs-blue" alt="Docs" /></a>
</p>
<p>BlueLibs Runner is a framework that provides a functional approach to building applications, whether small or large-scale. Its core concepts include Tasks, Resources, Events, and Middleware. Tasks represent the units of logic, while resources are singletons that provide shared services across the application. Events facilitate communication between different parts of the system, and middleware allows interception and modification of task execution. The framework emphasizes an async-first philosophy, ensuring that all operations are executed asynchronously for smoother application flow.</p>
<a id="md:building-blocks" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Building Blocks<a href="#md:building-blocks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>Tasks</strong>: Core units of logic that encapsulate specific tasks. They can depend on resources, other tasks, and event emitters.</li>
<li><strong>Resources</strong>: Singleton objects providing shared functionality. They can be constants, services, functions. They can depend on other resources, tasks, and event emitters.</li>
<li><strong>Events</strong>: Facilitate asynchronous communication between different parts of your application. All tasks and resources emit events, allowing you to easily hook. Events can be listened to by tasks, resources, and middleware.</li>
<li><strong>Middleware</strong>: Intercept and modify the execution of tasks. They can be used to add additional functionality to your tasks. Middleware can be global or task-specific.</li>
</ul>
<p>These are the concepts and philosophy:</p>
<ul>
<li><strong>Async</strong>: Everything is async, no more sync code for this framework. Sync-code can be done via resource services or within tasks, but the high-level flow needs to run async.</li>
<li><strong>Type safety</strong>: Built with TypeScript for enhanced developer experience and type-safety everywhere, no more type mistakes.</li>
<li><strong>Functional</strong>: We use functions and objects instead of classes for DI. This is a functional approach to building applications.</li>
<li><strong>Explicit Registration</strong>: All tasks, resources, events, and middleware have to be explicitly registered to be used.</li>
<li><strong>Dependencies</strong>: Tasks, resources, and middleware can have access to each other by depending on one another and event emitters. This is a powerful way to explicitly declare the dependencies.</li>
</ul>
<p>Resources return through <code>async init()</code> their value to the container which can be used throughout the application. Resources might not have a value, they can just register things, like tasks, events, or middleware.</p>
<p>Tasks return through <code>async run()</code> function and the value from run, can be used throughout the application.</p>
<p>All tasks, resources, events, and middleware have to be explicitly registered to be used. Registration can only be done in resources.</p>
<a id="md:installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation<a href="#md:installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@bluelibs/runner</span>
</code><button type="button">Copy</button></pre>

<a id="md:basic-usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Basic Usage<a href="#md:basic-usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">minimal</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">&quot;Hello world!&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">minimal</span><span class="hl-1">).</span><span class="hl-0">then</span><span class="hl-1">((</span><span class="hl-4">result</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-4">result</span><span class="hl-1">).</span><span class="hl-0">toBe</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello world!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:resources-and-tasks" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Resources and Tasks<a href="#md:resources-and-tasks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Resources are singletons. They can be constants, services, functions, etc. They can depend on other resources, tasks, and event emitters.</p>
<p>On the other hand, tasks are designed to be trackable units of logic. Like things that handle a specific route on your HTTP server, or any kind of action that is needed from various places. This will allow you to easily track what is happening in your application.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloTask</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.hello&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello World!&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">helloTask</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">hello:</span><span class="hl-1"> </span><span class="hl-4">helloTask</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">_</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">deps</span><span class="hl-1">.</span><span class="hl-0">hello</span><span class="hl-1">();</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:when-to-use-each" class="tsd-anchor"></a><h3 class="tsd-anchor-link">When to use each?<a href="#md:when-to-use-each" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>It is unrealistic to create a task for everything you're doing in your system, not only it will be tedious for the developer, but it will affect performance unnecessarily. The idea is to think of a task of something that you want trackable as an action, for example:</p>
<ul>
<li>&quot;app.user.register&quot; - this is a task, registers the user, returns a token</li>
<li>&quot;app.user.createComment&quot; - this is a task, creates a comment, returns the comment</li>
<li>&quot;app.user.updateFriendList&quot; - this task can be re-used from many other tasks or resources as necessary</li>
</ul>
<p>Resources are more like services, they are singletons, they are meant to be used as a shared functionality across your application. They can be constants, services, functions, etc.</p>
<a id="md:resource-dispose" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Resource dispose()<a href="#md:resource-dispose" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Resources can have a <code>dispose()</code> method that can be used for cleanups. This is useful for cleaning up resources like closing database connections, etc. You typically want to use this when you have opened pending connections or you need to do some cleanup or a graceful shutdown.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">dbResource</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">config</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">db</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">connectToDatabase</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">db</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-7">// the value returned from init() will be passed to dispose()</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">dispose</span><span class="hl-1">(</span><span class="hl-4">db</span><span class="hl-1">, </span><span class="hl-4">config</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">db</span><span class="hl-1">.</span><span class="hl-0">close</span><span class="hl-1">();</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>If you want to call dispose, you have to do it through the global resource called <code>store</code>, as everything is encapsulated.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1">, </span><span class="hl-4">globals</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">dbResource</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">store:</span><span class="hl-1"> </span><span class="hl-4">globals</span><span class="hl-1">.</span><span class="hl-4">resources</span><span class="hl-1">.</span><span class="hl-4">store</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">_</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">// We use the fact that we can reuse the value we got from here</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">dispose</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">deps</span><span class="hl-1">.</span><span class="hl-4">store</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1">(),</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">value</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">app</span><span class="hl-1">);</span><br/><span class="hl-7">// To begin the disposal process.</span><br/><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">value</span><span class="hl-1">.</span><span class="hl-0">dispose</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<a id="md:resource-with" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Resource with()<a href="#md:resource-with" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Resources can be configured with a configuration object. This is useful when you want to pass in configuration to them. For example, you're building a library and you're initialising a mailer service, you can pass in the SMTP credentials as a configuration.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">type</span><span class="hl-1"> </span><span class="hl-8">Config</span><span class="hl-1"> = { </span><span class="hl-4">smtpUrl</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">; </span><span class="hl-4">defaultFrom</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> };</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">emailerResource</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">config</span><span class="hl-1">: </span><span class="hl-8">Config</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">// run config checks</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">sendEmail</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">to</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-4">subject</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-4">body</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">// send *email*</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><br/><span class="hl-1">    </span><span class="hl-7">// proper autocompletion is present</span><br/><span class="hl-1">    </span><span class="hl-4">emailerResource</span><span class="hl-1">.</span><span class="hl-0">with</span><span class="hl-1">({ </span><span class="hl-4">smtpUrl:</span><span class="hl-1"> </span><span class="hl-2">&quot;smtp://localhost&quot;</span><span class="hl-1">, </span><span class="hl-4">defaultFrom:</span><span class="hl-1"> </span><span class="hl-2">&quot;&quot;</span><span class="hl-1"> }),</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>If by any chance your main <code>app</code> has configs then they will be passed via the second argument of <code>run</code>, like this:</p>
<pre><code class="ts"><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">app</span><span class="hl-1">, </span><span class="hl-4">config</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="md:dependencies" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Dependencies<a href="#md:dependencies" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>You can depend on <code>tasks</code>, <code>resources</code>, <code>events</code> and (indirectly) on <code>middleware</code>.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloWorld</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">middleware:</span><span class="hl-1"> [</span><span class="hl-4">logMiddleware</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">userRegisteredEvent</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">helloWorld</span><span class="hl-1">, </span><span class="hl-4">logMiddleware</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">helloWorld</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">_</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">deps</span><span class="hl-1">.</span><span class="hl-0">helloWorld</span><span class="hl-1">();</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">app</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>Resources can also depend on other resources and tasks. We have a circular dependency checker which ensures consistency. If a circular dependency is detected, an error will be thrown showing you the exact pathways.</p>
<p>Tasks are not limited to this constraint, actions can use depend on each other freely.</p>
<a id="md:events" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Events<a href="#md:events" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>You emit events when certain things in your app happen, a user registered, a comment has been added, etc.
You listen to them through tasks and resources, and you can emit them from tasks and resources through <code>dependencies</code>.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">afterRegisterEvent</span><span class="hl-1"> = </span><span class="hl-0">event</span><span class="hl-1">&lt;{ </span><span class="hl-4">userId</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> }&gt;({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.user.afterRegister&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">root</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">afterRegisterEvent</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">afterRegisterEvent</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">_</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">// the event becomes a function that you run with the propper payload</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">deps</span><span class="hl-1">.</span><span class="hl-0">afterRegisterEvent</span><span class="hl-1">({ </span><span class="hl-4">userId:</span><span class="hl-1"> </span><span class="hl-4">string</span><span class="hl-1"> });</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>There are only 2 ways to listen to events:</p>
<a id="md:on-property" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code>on</code> property<a href="#md:on-property" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">afterRegisterEvent</span><span class="hl-1"> = </span><span class="hl-0">event</span><span class="hl-1">&lt;{ </span><span class="hl-4">userId</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> }&gt;({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.user.afterRegister&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloTask</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.hello&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">on:</span><span class="hl-1"> </span><span class="hl-4">afterRegisterEvent</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;User has been registered!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">afterRegisterEvent</span><span class="hl-1">, </span><span class="hl-4">helloTask</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">afterRegisterEvent</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">_</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">deps</span><span class="hl-1">.</span><span class="hl-0">afterRegisterEvent</span><span class="hl-1">({ </span><span class="hl-4">userId:</span><span class="hl-1"> </span><span class="hl-2">&quot;XXX&quot;</span><span class="hl-1"> });</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:hooks-property" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code>hooks</code> property<a href="#md:hooks-property" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This can only be applied to a <code>resource()</code>.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">global</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">afterRegisterEvent</span><span class="hl-1"> = </span><span class="hl-0">event</span><span class="hl-1">&lt;{ </span><span class="hl-4">userId</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1"> }&gt;({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.user.registered&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">root</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">afterRegisterEvent</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {},</span><br/><span class="hl-1">  </span><span class="hl-4">hooks:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">event:</span><span class="hl-1"> </span><span class="hl-4">global</span><span class="hl-1">.</span><span class="hl-4">events</span><span class="hl-1">.</span><span class="hl-4">afterInit</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;User has been registered!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">_</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">deps</span><span class="hl-1">.</span><span class="hl-0">afterRegisterEvent</span><span class="hl-1">({ </span><span class="hl-4">userId:</span><span class="hl-1"> </span><span class="hl-2">&quot;XXX&quot;</span><span class="hl-1"> });</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>When using hooks, inside resource() you benefit of autocompletion, in order to keep things clean, if your hooks become large and long consider switching to tasks and <code>on</code>. This is a more explicit way to listen to events, and your resource registers them.</p>
<p>The hooks from a <code>resource</code> are mostly used for configuration, and blending in the system.</p>
<a id="md:when-to-use-either" class="tsd-anchor"></a><h3 class="tsd-anchor-link">When to use either?<a href="#md:when-to-use-either" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><ul>
<li><code>hooks</code> are for resources to extend each other, compose functionalities, they are mostly used for configuration and blending in the system.</li>
<li><code>on</code> is for when you want to perform a task when something happens.</li>
</ul>
<a id="md:middleware" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Middleware<a href="#md:middleware" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Middleware is a way to intercept the execution of tasks or initialization of resources. It's a powerful way to add additional functionality. First middleware that gets registered is the first that runs, giving it a form of priority, the last middleware that runs is 'closest' to the task, most likely the last element inside <code>middleware</code> array at task level.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">logMiddleware</span><span class="hl-1"> = </span><span class="hl-0">middleware</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.middleware.log&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">// inject tasks, resources, eventCallers here.</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">data</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> { </span><span class="hl-6">taskDefinition</span><span class="hl-1">, </span><span class="hl-6">resourceDefinition</span><span class="hl-1">, </span><span class="hl-6">config</span><span class="hl-1">, </span><span class="hl-6">next</span><span class="hl-1">, </span><span class="hl-6">input</span><span class="hl-1"> } = </span><span class="hl-4">data</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-7">// The middleware can be for a task or a resource, depending on which you get the right elements.</span><br/><span class="hl-1">    </span><span class="hl-3">if</span><span class="hl-1"> (</span><span class="hl-4">taskDefinition</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Before task&quot;</span><span class="hl-1">, </span><span class="hl-4">taskDefinition</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">result</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">next</span><span class="hl-1">(</span><span class="hl-4">input</span><span class="hl-1">); </span><span class="hl-7">// pass the input to the next middleware or task</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;After task&quot;</span><span class="hl-1">, </span><span class="hl-4">taskDefinition</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-3">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Before resource&quot;</span><span class="hl-1">, </span><span class="hl-4">resourceDefinition</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">result</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">next</span><span class="hl-1">(</span><span class="hl-4">config</span><span class="hl-1">); </span><span class="hl-7">// pass the input to the next middleware or task</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;After resource&quot;</span><span class="hl-1">, </span><span class="hl-4">resourceDefinition</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloTask</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.hello&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">middleware:</span><span class="hl-1"> [</span><span class="hl-4">logMiddleware</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;User has been registered!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>However, if you want to register a middleware for all tasks and resources, here's how you can do it:</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">logMiddleware</span><span class="hl-1"> = </span><span class="hl-0">middleware</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.middleware.log&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">// ... rest</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">root</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">logMiddleware</span><span class="hl-1">.</span><span class="hl-0">global</span><span class="hl-1">() </span><span class="hl-7">/* this will apply to all tasks */</span><span class="hl-1">],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>The middleware can only be registered once. This means that if you register a middleware as global, you cannot specify it as a task middleware.</p>
<a id="md:errors" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Errors<a href="#md:errors" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>If an error is thrown in a task, the error will be propagated up to the top runner.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloWorld</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.helloWorld&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-3">throw</span><span class="hl-1"> </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&quot;Something went wrong&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">helloWorld</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">helloWorld</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">helloWorld</span><span class="hl-1">();</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">app</span><span class="hl-1">).</span><span class="hl-0">catch</span><span class="hl-1">((</span><span class="hl-4">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-4">err</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>You can listen to errors via events:</p>
<pre><code class="ts"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloWorld</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.onError&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">on:</span><span class="hl-1"> </span><span class="hl-4">helloWorld</span><span class="hl-1">.</span><span class="hl-4">events</span><span class="hl-1">.</span><span class="hl-4">onError</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-1">({ </span><span class="hl-4">error</span><span class="hl-1">, </span><span class="hl-4">input</span><span class="hl-1">, </span><span class="hl-4">suppress</span><span class="hl-1"> }, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">// this will be called when an error happens</span><br/><br/><span class="hl-1">    </span><span class="hl-7">// if you handled the error, and you don&#39;t want it propagated to the top, supress the propagation.</span><br/><span class="hl-1">    </span><span class="hl-0">suppress</span><span class="hl-1">();</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:metadata" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Metadata<a href="#md:metadata" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>You can attach metadata to tasks, resources, events, and middleware.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloWorld</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.helloWorld&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">meta:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">title:</span><span class="hl-1"> </span><span class="hl-2">&quot;Hello World&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;This is a hello world task&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">tags:</span><span class="hl-1"> [</span><span class="hl-2">&quot;api&quot;</span><span class="hl-1">],</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">&quot;Hello World!&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>This is particularly helpful to use in conjunction with global middlewares, or global events, they can read some meta tag definition and act accordingly.</p>
<p>The interfaces look like this:</p>
<pre><code class="ts"><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-5">interface</span><span class="hl-1"> </span><span class="hl-8">IMeta</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">title</span><span class="hl-1">?: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">description</span><span class="hl-1">?: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-4">tags</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">[];</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-5">interface</span><span class="hl-1"> </span><span class="hl-8">ITaskMeta</span><span class="hl-1"> </span><span class="hl-5">extends</span><span class="hl-1"> </span><span class="hl-8">IMeta</span><span class="hl-1"> {}</span><br/><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-5">interface</span><span class="hl-1"> </span><span class="hl-8">IResourceMeta</span><span class="hl-1"> </span><span class="hl-5">extends</span><span class="hl-1"> </span><span class="hl-8">IMeta</span><span class="hl-1"> {}</span><br/><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-5">interface</span><span class="hl-1"> </span><span class="hl-8">IEventMeta</span><span class="hl-1"> </span><span class="hl-5">extends</span><span class="hl-1"> </span><span class="hl-8">IMeta</span><span class="hl-1"> {}</span><br/><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-5">interface</span><span class="hl-1"> </span><span class="hl-8">IMiddlewareMeta</span><span class="hl-1"> </span><span class="hl-5">extends</span><span class="hl-1"> </span><span class="hl-8">IMeta</span><span class="hl-1"> {}</span>
</code><button type="button">Copy</button></pre>

<p>Which means you can extend them in your system to add more keys to better describe your actions.</p>
<a id="md:global-services" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Global Services<a href="#md:global-services" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>We expose direct access to the following internal services:</p>
<ul>
<li>Store (contains Map()s for events, tasks, resources, middleware configurations)</li>
<li>TaskRunner (can run tasks definitions directly and within D.I. context)</li>
<li>EventManager (can emit and listen to events)</li>
</ul>
<p>Attention, it is not recommended to use these services directly, but they are exposed for advanced use-cases, for when you do not have any other way.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">globals</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloWorld</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.helloWorld&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">store:</span><span class="hl-1"> </span><span class="hl-4">globals</span><span class="hl-1">.</span><span class="hl-4">resources</span><span class="hl-1">.</span><span class="hl-4">store</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">taskRunner:</span><span class="hl-1"> </span><span class="hl-4">globals</span><span class="hl-1">.</span><span class="hl-4">resources</span><span class="hl-1">.</span><span class="hl-4">taskRunner</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">eventManager:</span><span class="hl-1"> </span><span class="hl-4">globals</span><span class="hl-1">.</span><span class="hl-4">resources</span><span class="hl-1">.</span><span class="hl-4">eventManager</span><span class="hl-1">,</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">_</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">// you benefit of full autocompletion here</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:namespacing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Namespacing<a href="#md:namespacing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>We typically namespace using <code>.</code> like <code>app.helloWorld</code>. This is a convention that we use to make sure that we can easily identify where the task belongs to.</p>
<p>When creating special packages the convention is:</p>
<ul>
<li><code>{companyName}.{packageName}.{taskName}</code></li>
</ul>
<p>You can always create helpers for you as you're creating your tasks, resources, middleware:</p>
<pre><code class="ts"><span class="hl-5">function</span><span class="hl-1"> </span><span class="hl-0">getNamespace</span><span class="hl-1">(</span><span class="hl-4">id</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">`bluelibs.core.</span><span class="hl-5">${</span><span class="hl-4">id</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>We need to import all the tasks, resources, events, and middlewares, a convention for their naming is to export them like this</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">userCreatedEvent</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./events&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">events</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-4">userCreated:</span><span class="hl-1"> </span><span class="hl-4">userCreatedEvent</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">// ...</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">tasks</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-4">doSomething:</span><span class="hl-1"> </span><span class="hl-4">doSomethingTask</span><span class="hl-1">,</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">export</span><span class="hl-1"> </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">resources</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-4">root:</span><span class="hl-1"> </span><span class="hl-4">rootResource</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">user:</span><span class="hl-1"> </span><span class="hl-4">userResource</span><span class="hl-1">,</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<p>Often the root will register all needed items, so you don't have to register anything but the root.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">resource</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-5">*</span><span class="hl-1"> </span><span class="hl-3">as</span><span class="hl-1"> </span><span class="hl-4">packageName</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;package-name&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">packageName</span><span class="hl-1">.</span><span class="hl-4">resources</span><span class="hl-1">.</span><span class="hl-4">root</span><span class="hl-1">],</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">app</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>Now you can freely use any of the tasks, resources, events, and middlewares from the <code>packageName</code> namespace.</p>
<p>This approach is very powerful when you have multiple packages and you want to compose them together.</p>
<a id="md:real-world-examples" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Real world examples<a href="#md:real-world-examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Typically you have an express server (to handle HTTP requests), a database, and a bunch of services. You can define all of these in a single file and run them.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">express</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;express&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">expressServer</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.express&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">express</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-4">app</span><span class="hl-1">.</span><span class="hl-0">listen</span><span class="hl-1">(</span><span class="hl-9">3000</span><span class="hl-1">).</span><span class="hl-0">then</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;Server is running on port 3000&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><br/><span class="hl-1">    </span><span class="hl-7">// because we return it you can now access it via dependencies</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">app</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">setupRoutes</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.routes&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">expressServer</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">_</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">deps</span><span class="hl-1">.</span><span class="hl-4">expressServer</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">(</span><span class="hl-2">&quot;/api&quot;</span><span class="hl-1">, (</span><span class="hl-4">req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-4">hello:</span><span class="hl-1"> </span><span class="hl-2">&quot;world&quot;</span><span class="hl-1"> });</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-7">// Just run them, init() will be called everywhere.</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">expressServer</span><span class="hl-1">, </span><span class="hl-4">setupRoutes</span><span class="hl-1">],</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">run</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<p>The system is smart enough to know which <code>init()</code> to call first. Typically all dependencies are initialised first. If there are circular dependencies, an error will be thrown with the exact paths.</p>
<a id="md:business-config" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Business config<a href="#md:business-config" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>There's a resource for that! You can define a resource that holds your business configuration.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">resource</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">// we keep it as const because we will also benefit of type-safety</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">businessData</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-4">pricePerSubscription:</span><span class="hl-1"> </span><span class="hl-9">9.99</span><span class="hl-1">,</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">businessConfig</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.config&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">businessData</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">businessConfig</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> { </span><span class="hl-4">businessConfig</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">_</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">deps</span><span class="hl-1">.</span><span class="hl-4">businessConfig</span><span class="hl-1">.</span><span class="hl-4">pricePerSubscription</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">run</span><span class="hl-1">();</span>
</code><button type="button">Copy</button></pre>

<a id="md:global-events" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Global Events<a href="#md:global-events" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="md:task-level" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Task level<a href="#md:task-level" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloWorld</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.helloWorld&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-7">// Each task and constant have their own events</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">helloWorld</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">hooks:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">event:</span><span class="hl-1"> </span><span class="hl-4">helloWorld</span><span class="hl-1">.</span><span class="hl-4">events</span><span class="hl-1">.</span><span class="hl-4">beforeRun</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">input</span><span class="hl-1">; </span><span class="hl-7">// read the input</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">event:</span><span class="hl-1"> </span><span class="hl-4">helloWorld</span><span class="hl-1">.</span><span class="hl-4">events</span><span class="hl-1">.</span><span class="hl-4">afterRun</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">output</span><span class="hl-1">; </span><span class="hl-7">// you can read the input or output</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">event:</span><span class="hl-1"> </span><span class="hl-4">helloWorld</span><span class="hl-1">.</span><span class="hl-4">events</span><span class="hl-1">.</span><span class="hl-4">onError</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">error</span><span class="hl-1">; </span><span class="hl-7">// read the error that happened during execution</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">app</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="md:business-config-1" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Business Config<a href="#md:business-config-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">businessData</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-4">pricePerSubscription:</span><span class="hl-1"> </span><span class="hl-9">9.99</span><span class="hl-1">,</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">businessConfig</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.config&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">businessData</span><span class="hl-1">; </span><span class="hl-7">// if you use it as a const you will have full typesafety</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">businessConfig</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">hooks:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">event:</span><span class="hl-1"> </span><span class="hl-4">businessConfig</span><span class="hl-1">.</span><span class="hl-4">events</span><span class="hl-1">.</span><span class="hl-4">beforeInit</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">config</span><span class="hl-1">; </span><span class="hl-7">// read the input</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">event:</span><span class="hl-1"> </span><span class="hl-4">businessConfig</span><span class="hl-1">.</span><span class="hl-4">events</span><span class="hl-1">.</span><span class="hl-4">afterInit</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">value</span><span class="hl-1">; </span><span class="hl-7">// you can read the  returned value of the resource</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">event:</span><span class="hl-1"> </span><span class="hl-4">businessConfig</span><span class="hl-1">.</span><span class="hl-4">events</span><span class="hl-1">.</span><span class="hl-4">onError</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">data</span><span class="hl-1">.</span><span class="hl-4">error</span><span class="hl-1">; </span><span class="hl-7">// read the error that happened during initialization</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">app</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="md:moving-further" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Moving further<a href="#md:moving-further" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This is just a &quot;language&quot; of developing applications. It simplifies dependency injection to the barebones, it forces you to think more functional and use classes less.</p>
<p>This doesn't mean you shouldn't use classes, just not for hooking things up together.</p>
<p>You can add many services or external things into the runner ecosystem with things like:</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">expressResource</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">&lt;</span><span class="hl-8">express</span><span class="hl-1">.</span><span class="hl-8">Application</span><span class="hl-1">&gt;({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.helloWorld&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">config</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">config</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">expressResource</span><span class="hl-1">.</span><span class="hl-0">with</span><span class="hl-1">(</span><span class="hl-0">express</span><span class="hl-1">())],</span><br/><span class="hl-1">  </span><span class="hl-0">init</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">express</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">express</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&quot;/&quot;</span><span class="hl-1">, (</span><span class="hl-4">req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello World!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">app</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>This shows how easy you encapsulate an external service into the runner ecosystem. This 'pattern' of storing objects like this is not that common because usually they require a configuration with propper options and stuff, not an express instance(), like this:</p>
<pre><code class="ts"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">expressResource</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.helloWorld&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">config</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">express</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-4">app</span><span class="hl-1">.</span><span class="hl-0">listen</span><span class="hl-1">(</span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">port</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-4">app</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">expressResource</span><span class="hl-1">.</span><span class="hl-0">with</span><span class="hl-1">({ </span><span class="hl-4">port:</span><span class="hl-1"> </span><span class="hl-9">3000</span><span class="hl-1"> })],</span><br/><span class="hl-1">  </span><span class="hl-0">init</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">express</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">// type is automagically infered.</span><br/><span class="hl-1">    </span><span class="hl-4">express</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&quot;/&quot;</span><span class="hl-1">, (</span><span class="hl-4">req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello World!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">app</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="md:inter-communication-between-resources" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Inter-communication between resources<a href="#md:inter-communication-between-resources" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>By stating dependencies you often don't care about the initialisation order, but sometimes you really do, for example, let's imagine a security service that allows you to inject a custom hashing function let's say to shift from md5 to sha256.</p>
<p>This means your <code>resource</code> needs to provide a way for other resources to <code>update</code> it. The most obvious way is to expose a configuration that allows you to set a custom hasher <code>register: [securityResource.with({ ... })]</code>.</p>
<p>But other resources might want to do this dynamically as extensions. This is where <code>hooks</code> come in.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">resource</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">type</span><span class="hl-1"> </span><span class="hl-8">SecurityOptions</span><span class="hl-1"> = {</span><br/><span class="hl-1">  </span><span class="hl-0">hashFunction</span><span class="hl-1">: (</span><span class="hl-4">input</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">securityResource</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.security&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">config</span><span class="hl-1">: </span><span class="hl-8">SecurityOptions</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">let</span><span class="hl-1"> </span><span class="hl-4">hasher</span><span class="hl-1"> = </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-4">hashFunction</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">setHasher</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-0">hashFunction</span><span class="hl-1">: (</span><span class="hl-4">input</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-8">string</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">hasher</span><span class="hl-1"> = </span><span class="hl-4">hashFunction</span><span class="hl-1">;</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-0">hash</span><span class="hl-4">:</span><span class="hl-1"> (</span><span class="hl-4">input</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">hasher</span><span class="hl-1">(</span><span class="hl-4">input</span><span class="hl-1">),</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">securityResource</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">hooks:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">event:</span><span class="hl-1"> </span><span class="hl-4">securityResource</span><span class="hl-1">.</span><span class="hl-4">events</span><span class="hl-1">.</span><span class="hl-4">afterInit</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">const</span><span class="hl-1"> { </span><span class="hl-6">config</span><span class="hl-1">, </span><span class="hl-6">value</span><span class="hl-1"> } = </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">data</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">security</span><span class="hl-1"> = </span><span class="hl-4">value</span><span class="hl-1">;</span><br/><br/><span class="hl-1">        </span><span class="hl-4">security</span><span class="hl-1">.</span><span class="hl-0">setHasher</span><span class="hl-1">((</span><span class="hl-4">input</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-7">// custom implementation here.</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Another approach is to create a new event that holds the config and it allows it to be updated.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">resource</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">securityConfigurationPhaseEvent</span><span class="hl-1"> = </span><span class="hl-0">event</span><span class="hl-1">&lt;</span><span class="hl-8">SecurityOptions</span><span class="hl-1">&gt;({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.security.configurationPhase&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">securityResource</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.security&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">securityConfigurationPhaseEvent</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">config</span><span class="hl-1">: </span><span class="hl-8">SecurityOptions</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">// Give the ability to other listeners to modify the configuration</span><br/><span class="hl-1">    </span><span class="hl-0">securityConfigurationPhaseEvent</span><span class="hl-1">(</span><span class="hl-4">config</span><span class="hl-1">);</span><br/><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">// ... based on config</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">securityResource</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-4">hooks:</span><span class="hl-1"> [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-4">event:</span><span class="hl-1"> </span><span class="hl-4">securityConfigurationPhaseEvent</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">const</span><span class="hl-1"> { </span><span class="hl-6">config</span><span class="hl-1"> } = </span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">data</span><span class="hl-1">; </span><span class="hl-7">// config is SecurityOptions</span><br/><span class="hl-1">        </span><span class="hl-4">config</span><span class="hl-1">.</span><span class="hl-0">setHasher</span><span class="hl-1">(</span><span class="hl-4">newHashFunction</span><span class="hl-1">);</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:overrides" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Overrides<a href="#md:overrides" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Previously, we explored how we can extend functionality through events. However, sometimes you want to override a resource with a new one or simply swap out a task or a middleware that you import from another package and they don't offer the ability.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">resource</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">// This example is for resources but override works for tasks, events, and middleware as well.</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">securityResource</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.security&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-5">async</span><span class="hl-1"> </span><span class="hl-0">init</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-7">// returns a security service</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">override</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  ...</span><span class="hl-4">securityResource</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">init</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">// a new and custom service</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">securityResource</span><span class="hl-1">], </span><span class="hl-7">// this resource might be registered by any element in the dependency tree.</span><br/><span class="hl-1">  </span><span class="hl-4">overrides:</span><span class="hl-1"> [</span><span class="hl-4">override</span><span class="hl-1">],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Now the <code>securityResource</code> will be overriden by the new one and whenever it's used it will use the new one.</p>
<p>Overrides can only happen once and only if the overriden resource is registered. If two resources try to override the same resource, an error will be thrown.</p>
<a id="md:logging" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Logging<a href="#md:logging" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>We expose through globals a logger that you can use to log things.</p>
<p>By default logs are not printed unless a resource listens to the log event. This is by design, when something is logged an event is emitted. You can listen to this event and print the logs.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">globals</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloWorld</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.helloWorld&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">logger:</span><span class="hl-1"> </span><span class="hl-4">globals</span><span class="hl-1">.</span><span class="hl-4">resources</span><span class="hl-1">.</span><span class="hl-4">logger</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">_</span><span class="hl-1">, { </span><span class="hl-4">logger</span><span class="hl-1"> }) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">logger</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello World!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">// or logger.log(level, data);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:logs-summary-table" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Logs Summary Table<a href="#md:logs-summary-table" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><table>
<thead>
<tr>
<th>Log Level</th>
<th>Description</th>
<th>Usage Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>trace</strong></td>
<td>Very detailed logs, usually for debugging</td>
<td>&quot;Entering function X with params Y.&quot;</td>
</tr>
<tr>
<td><strong>debug</strong></td>
<td>Detailed debug information</td>
<td>&quot;Fetching user data: userId=123.&quot;</td>
</tr>
<tr>
<td><strong>info</strong></td>
<td>General application information</td>
<td>&quot;Service started on port 8080.&quot;</td>
</tr>
<tr>
<td><strong>warn</strong></td>
<td>Indicates a potential issue</td>
<td>&quot;Disk space running low.&quot;</td>
</tr>
<tr>
<td><strong>error</strong></td>
<td>Indicates a significant problem</td>
<td>&quot;Unable to connect to database.&quot;</td>
</tr>
<tr>
<td><strong>critical</strong></td>
<td>Serious problem causing a crash</td>
<td>&quot;System out of memory, shutting down.&quot;</td>
</tr>
</tbody>
</table>
<a id="md:print-logs" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Print logs<a href="#md:print-logs" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Logs don't get printed by default in this system.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">event</span><span class="hl-1">, </span><span class="hl-4">globals</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">printLog</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.task.printLog&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">on:</span><span class="hl-1"> </span><span class="hl-4">globals</span><span class="hl-1">.</span><span class="hl-4">events</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">dependencies:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">logger:</span><span class="hl-1"> </span><span class="hl-4">globals</span><span class="hl-1">.</span><span class="hl-4">resources</span><span class="hl-1">.</span><span class="hl-4">logger</span><span class="hl-1">,</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">event</span><span class="hl-1">, { </span><span class="hl-4">logger</span><span class="hl-1"> }) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">logger</span><span class="hl-1">.</span><span class="hl-0">print</span><span class="hl-1">(</span><span class="hl-4">event</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;root&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">printLog</span><span class="hl-1">],</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-7">// Now your app will print all logs</span>
</code><button type="button">Copy</button></pre>

<p>You can in theory do it in <code>hooks</code> as well, but as specified <code>hooks</code> are mostly used for configuration and blending in the system.</p>
<p>The logger's <code>log()</code> function is async as it works with events. If you don't want your system hanging on logs, simply omit the <code>await</code></p>
<a id="md:testing" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Testing<a href="#md:testing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="md:unit-testing" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Unit Testing<a href="#md:unit-testing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>You can easily test your resources and tasks by running them in a test environment.</p>
<p>The only bits that you need to test are the <code>run</code> function and the <code>init</code> functions with the propper dependencies.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloWorld</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.helloWorld&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">&quot;Hello World!&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">helloWorldResource</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.helloWorldResource&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">init</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">&quot;Hello World!&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-7">// sample tests for the task</span><br/><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&quot;app.helloWorld&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&quot;should return Hello World!&quot;</span><span class="hl-1">, </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">result</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">helloWorld</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">input</span><span class="hl-1">, </span><span class="hl-4">dependencies</span><span class="hl-1">); </span><span class="hl-7">// pass in the arguments and the mocked dependencies.</span><br/><span class="hl-1">    </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-4">result</span><span class="hl-1">).</span><span class="hl-0">toBe</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello World!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-7">// sample tests for the resource</span><br/><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&quot;app.helloWorldResource&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&quot;should return Hello World!&quot;</span><span class="hl-1">, </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">result</span><span class="hl-1"> = </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-4">helloWorldResource</span><span class="hl-1">.</span><span class="hl-0">init</span><span class="hl-1">(</span><span class="hl-4">config</span><span class="hl-1">, </span><span class="hl-4">dependencies</span><span class="hl-1">); </span><span class="hl-7">// pass in the arguments and the mocked dependencies.</span><br/><span class="hl-1">    </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-4">result</span><span class="hl-1">).</span><span class="hl-0">toBe</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello World!&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:integration" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Integration<a href="#md:integration" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Unit testing can be very simply with mocks, since all dependencies are explicit. However, if you would like to run an integration test, and have a task be tested and within the full container.</p>
<pre><code class="ts"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-4">task</span><span class="hl-1">, </span><span class="hl-4">resource</span><span class="hl-1">, </span><span class="hl-4">run</span><span class="hl-1">, </span><span class="hl-4">global</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&quot;@bluelibs/runner&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">task</span><span class="hl-1"> = </span><span class="hl-0">task</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.myTask&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">run</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">return</span><span class="hl-1"> </span><span class="hl-2">&quot;Hello World!&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">myTask</span><span class="hl-1">],</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Then your tests can now be cleaner:</p>
<pre><code class="ts"><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&quot;app&quot;</span><span class="hl-1">, () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&quot;an example to override a task or resource&quot;</span><span class="hl-1">, </span><span class="hl-5">async</span><span class="hl-1"> () </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">testApp</span><span class="hl-1"> = </span><span class="hl-0">resource</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-4">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;app.test&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">register:</span><span class="hl-1"> [</span><span class="hl-4">myApp</span><span class="hl-1">], </span><span class="hl-7">// wrap your existing app</span><br/><span class="hl-1">      </span><span class="hl-4">overrides:</span><span class="hl-1"> [</span><span class="hl-4">override</span><span class="hl-1">], </span><span class="hl-7">// apply the overrides</span><br/><span class="hl-1">      </span><span class="hl-0">init</span><span class="hl-4">:</span><span class="hl-1"> </span><span class="hl-5">async</span><span class="hl-1"> (</span><span class="hl-4">_</span><span class="hl-1">, </span><span class="hl-4">deps</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">// you can now test a task simply by depending on it, and running it, then asserting the response of run()</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">    });</span><br/><br/><span class="hl-1">    </span><span class="hl-7">// Same concept applies for resources as well.</span><br/><br/><span class="hl-1">    </span><span class="hl-3">await</span><span class="hl-1"> </span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-4">testApp</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<a id="md:support" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Support<a href="#md:support" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This package is part of the <a href="https://www.bluelibs.com" target="_blank" class="external">BlueLibs</a> family. If you enjoy this work, please show your support by starring <a href="https://github.com/bluelibs/runner" target="_blank" class="external">the main repository</a>.</p>
<a id="md:license" class="tsd-anchor"></a><h2 class="tsd-anchor-link">License<a href="#md:license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This project is licensed under the MIT License - see the <a href="media/LICENSE.md">LICENSE.md</a> file for details.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:bluelibs-runner"><span>Blue<wbr/>Libs <wbr/>Runner</span></a><ul><li><a href="#md:building-blocks"><span>Building <wbr/>Blocks</span></a></li><li><a href="#md:installation"><span>Installation</span></a></li><li><a href="#md:basic-usage"><span>Basic <wbr/>Usage</span></a></li><li><a href="#md:resources-and-tasks"><span>Resources and <wbr/>Tasks</span></a></li><li><ul><li><a href="#md:when-to-use-each"><span>When to use each?</span></a></li><li><a href="#md:resource-dispose"><span>Resource dispose()</span></a></li><li><a href="#md:resource-with"><span>Resource with()</span></a></li></ul></li><li><a href="#md:dependencies"><span>Dependencies</span></a></li><li><a href="#md:events"><span>Events</span></a></li><li><ul><li><a href="#md:on-property"><span>on property</span></a></li><li><a href="#md:hooks-property"><span>hooks property</span></a></li><li><a href="#md:when-to-use-either"><span>When to use either?</span></a></li></ul></li><li><a href="#md:middleware"><span>Middleware</span></a></li><li><a href="#md:errors"><span>Errors</span></a></li><li><a href="#md:metadata"><span>Metadata</span></a></li><li><a href="#md:global-services"><span>Global <wbr/>Services</span></a></li><li><a href="#md:namespacing"><span>Namespacing</span></a></li><li><a href="#md:real-world-examples"><span>Real world examples</span></a></li><li><ul><li><a href="#md:business-config"><span>Business config</span></a></li></ul></li><li><a href="#md:global-events"><span>Global <wbr/>Events</span></a></li><li><ul><li><a href="#md:task-level"><span>Task level</span></a></li><li><a href="#md:business-config-1"><span>Business <wbr/>Config</span></a></li><li><a href="#md:moving-further"><span>Moving further</span></a></li><li><a href="#md:inter-communication-between-resources"><span>Inter-<wbr/>communication between resources</span></a></li></ul></li><li><a href="#md:overrides"><span>Overrides</span></a></li><li><a href="#md:logging"><span>Logging</span></a></li><li><ul><li><a href="#md:logs-summary-table"><span>Logs <wbr/>Summary <wbr/>Table</span></a></li><li><a href="#md:print-logs"><span>Print logs</span></a></li></ul></li><li><a href="#md:testing"><span>Testing</span></a></li><li><ul><li><a href="#md:unit-testing"><span>Unit <wbr/>Testing</span></a></li><li><a href="#md:integration"><span>Integration</span></a></li></ul></li><li><a href="#md:support"><span>Support</span></a></li><li><a href="#md:license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>@bluelibs/runner - v1.2.0</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
